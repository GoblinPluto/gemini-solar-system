<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Interactive Solar System Simulation</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            user-select: none; /* Prevent text selection while clicking */
        }

        body {
            background-color: #050505; /* Deep space black */
            overflow: hidden; /* Prevent scrollbars */
            color: white;
        }

        canvas {
            display: block;
        }

        /* --- Controls HUD --- */
        #controls-hud {
            position: absolute;
            bottom: 30px;
            left: 50%;
            transform: translateX(-50%);
            display: flex;
            align-items: center;
            gap: 20px;
            background: rgba(40, 40, 40, 0.8);
            backdrop-filter: blur(8px);
            padding: 12px 25px;
            border-radius: 50px;
            border: 1px solid rgba(255, 255, 255, 0.15);
            box-shadow: 0 10px 30px rgba(0,0,0,0.6);
            z-index: 50;
        }

        .control-group {
            display: flex;
            align-items: center;
            gap: 10px;
            color: #ddd;
            font-size: 0.9rem;
        }

        .separator {
            width: 1px;
            height: 25px;
            background: rgba(255,255,255,0.2);
        }

        .hud-btn {
            background: rgba(255,255,255,0.1);
            border: 1px solid rgba(255,255,255,0.1);
            color: #ddd;
            width: 32px;
            height: 32px;
            border-radius: 50%;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1rem;
            transition: all 0.2s;
        }

        .hud-btn:hover {
            background: rgba(255,255,255,0.3);
            transform: scale(1.1);
            color: white;
        }

        /* Range Slider Styling */
        input[type=range] {
            -webkit-appearance: none; 
            width: 120px; 
            background: transparent; 
        }

        input[type=range]::-webkit-slider-thumb {
            -webkit-appearance: none;
            height: 16px;
            width: 16px;
            border-radius: 50%;
            background: #ffffff;
            cursor: pointer;
            margin-top: -6px; 
            box-shadow: 0 0 5px rgba(0,0,0,0.5);
        }

        input[type=range]::-webkit-slider-runnable-track {
            width: 100%;
            height: 4px;
            cursor: pointer;
            background: rgba(255,255,255,0.3);
            border-radius: 2px;
        }

        /* --- UI Overlay for Planet Info --- */
        #info-panel {
            position: absolute;
            top: 20px;
            right: 20px;
            width: 320px;
            /* Dark Gray Transparent Theme */
            background: rgba(30, 30, 35, 0.92);
            backdrop-filter: blur(12px);
            border: 1px solid rgba(100, 100, 100, 0.4);
            border-radius: 12px;
            padding: 25px;
            transform: translateX(120%); /* Hidden by default */
            transition: transform 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.7);
            pointer-events: none; 
        }

        #info-panel.active {
            transform: translateX(0);
            pointer-events: auto;
        }

        h2 {
            margin-bottom: 15px;
            color: #f0f0f0;
            text-transform: uppercase;
            letter-spacing: 2px;
            font-size: 1.5rem;
            border-bottom: 1px solid rgba(255,255,255,0.15);
            padding-bottom: 10px;
        }

        .data-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px 10px;
            margin-bottom: 20px;
        }

        .data-item {
            display: flex;
            flex-direction: column;
        }

        .label {
            color: #999;
            font-size: 0.75rem;
            text-transform: uppercase;
            margin-bottom: 4px;
        }

        .value {
            font-weight: 600;
            color: #fff;
            font-size: 0.95rem;
        }

        .description {
            font-size: 0.9rem;
            line-height: 1.5;
            color: #ccc;
            padding-top: 10px;
            border-top: 1px solid rgba(255,255,255,0.1);
        }

        #close-btn {
            position: absolute;
            top: 10px;
            right: 15px;
            background: none;
            border: none;
            color: #888;
            font-size: 1.5rem;
            cursor: pointer;
            transition: color 0.2s;
            line-height: 1;
        }
        #close-btn:hover { color: white; }

        #hint {
            position: absolute;
            top: 20px;
            left: 20px;
            color: rgba(255, 255, 255, 0.4);
            font-size: 0.9rem;
            pointer-events: none;
        }
    </style>
</head>
<body>

    <canvas id="solarCanvas"></canvas>

    <div id="hint">Mouse Wheel to Zoom • Drag to Pan</div>

    <!-- Controls HUD -->
    <div id="controls-hud">
        <div class="control-group">
            <span>Speed</span>
            <!-- changed value to 0.1 -->
            <input type="range" id="speed-slider" min="0" max="5" step="0.1" value="0.1">
            <!-- changed text to 0.1x -->
            <span id="speed-display">0.1x</span>
        </div>
        <div class="separator"></div>
        <div class="control-group">
            <button class="hud-btn" onclick="adjustZoom(-0.2)" title="Zoom Out">➖</button>
            <button class="hud-btn" onclick="adjustZoom(0.2)" title="Zoom In">➕</button>
        </div>
    </div>

    <!-- Planet Info Panel -->
    <div id="info-panel">
        <button id="close-btn">&times;</button>
        <h2 id="p-name">Earth</h2>
        
        <div class="data-grid">
            <div class="data-item">
                <span class="label">Orbit Speed</span>
                <span class="value" id="p-speed">29.8 km/s</span>
            </div>
            <div class="data-item">
                <span class="label">Distance</span>
                <span class="value" id="p-dist">149.6 M km</span>
            </div>
            <div class="data-item">
                <span class="label">Surface Temp</span>
                <span class="value" id="p-temp">15°C</span>
            </div>
            <div class="data-item">
                <span class="label">Gravity</span>
                <span class="value" id="p-gravity">9.8 m/s²</span>
            </div>
            <div class="data-item">
                <span class="label">Day Length</span>
                <span class="value" id="p-day">24 Hours</span>
            </div>
        </div>

        <p class="description" id="p-desc">
            The third planet from the Sun.
        </p>
    </div>

    <script>
        const canvas = document.getElementById('solarCanvas');
        const ctx = canvas.getContext('2d');
        
        let width, height, centerX, centerY;
        let baseScale = 1; 
        let zoomLevel = 1.0;
        // changed default speed to 0.1
        let simSpeed = 0.1;
        let offsetX = 0;
        let offsetY = 0;
        let isDragging = false;
        let lastMouseX, lastMouseY;

        function resize() {
            width = window.innerWidth;
            height = window.innerHeight;
            canvas.width = width;
            canvas.height = height;
            centerX = width / 2;
            centerY = height / 2;
            baseScale = Math.min(width, height) / 900; 
        }
        window.addEventListener('resize', resize);
        resize();

        // --- Controls Logic ---
        const speedSlider = document.getElementById('speed-slider');
        const speedDisplay = document.getElementById('speed-display');

        speedSlider.addEventListener('input', (e) => {
            simSpeed = parseFloat(e.target.value);
            speedDisplay.textContent = simSpeed.toFixed(1) + 'x';
        });

        function adjustZoom(delta) {
            zoomLevel += delta;
            zoomLevel = Math.max(0.2, Math.min(zoomLevel, 5.0));
        }

        // --- Configuration Data ---
        // Eccentricity (ecc) determines how oval the orbit is (0 = circle, 0.9 = flat oval)
        // We use slightly exaggerated values for visual clarity (e.g. Mercury 0.2 -> 0.25)
        const planets = [
            {
                name: "Mercury", type: "terrestrial", radius: 4, distance: 60, speed: 0.04,
                color: ["#a5a5a5", "#5c5c5c"], orbitColor: "#444",
                realSpeed: "47.4 km/s", realDist: "57.9 M km", temp: "167°C",
                gravity: "3.7 m/s²", dayLength: "59 Earth Days",
                ecc: 0.25, periapsis: 0.5, // High eccentricity, tilted orbit
                desc: "Smallest planet. It looks like Earth's moon with many craters. It has almost no atmosphere to retain heat."
            },
            {
                name: "Venus", type: "atmosphere", radius: 7, distance: 90, speed: 0.025,
                color: ["#e3bb76", "#d1a055"], orbitColor: "#554d38",
                realSpeed: "35.0 km/s", realDist: "108.2 M km", temp: "464°C",
                gravity: "8.87 m/s²", dayLength: "243 Earth Days",
                ecc: 0.01, periapsis: 2.0, // Nearly circular
                desc: "Thick, toxic atmosphere traps heat, making it the hottest planet. It spins in the opposite direction to most planets."
            },
            {
                name: "Earth", type: "earth", radius: 7.5, distance: 130, speed: 0.02,
                color: ["#22a6b3", "#1e7e87"], orbitColor: "#224455",
                realSpeed: "29.8 km/s", realDist: "149.6 M km", temp: "15°C",
                gravity: "9.8 m/s²", dayLength: "24 Hours",
                ecc: 0.02, periapsis: 1.0,
                desc: "Our home. The only world with liquid water on the surface and life as we know it."
            },
            {
                name: "Mars", type: "terrestrial", radius: 5, distance: 170, speed: 0.016,
                color: ["#eb4d4b", "#c23616"], orbitColor: "#552222",
                realSpeed: "24.1 km/s", realDist: "227.9 M km", temp: "-65°C",
                gravity: "3.71 m/s²", dayLength: "24.6 Hours",
                ecc: 0.15, periapsis: 3.5, // Visibly oval
                desc: "The Red Planet. Iron oxide dust gives it the reddish color. It has the largest volcano in the solar system."
            },
            {
                name: "Jupiter", type: "gas", radius: 18, distance: 260, speed: 0.008,
                color: ["#f0932b", "#d35400"], orbitColor: "#554422",
                realSpeed: "13.1 km/s", realDist: "778.6 M km", temp: "-110°C",
                gravity: "24.79 m/s²", dayLength: "9.9 Hours",
                ecc: 0.05, periapsis: 0.2,
                desc: "The largest planet. A gas giant with massive storms and bands of clouds. It has more than 75 moons."
            },
            {
                name: "Saturn", type: "ringed", radius: 16, distance: 340, speed: 0.006,
                color: ["#f6e58d", "#f0932b"], orbitColor: "#555533",
                realSpeed: "9.7 km/s", realDist: "1.4 B km", temp: "-140°C",
                gravity: "10.44 m/s²", dayLength: "10.7 Hours",
                ecc: 0.06, periapsis: 4.0,
                desc: "Famous for its extensive and complex ring system made of ice and rock particles."
            },
            {
                name: "Uranus", type: "gas", radius: 12, distance: 400, speed: 0.004,
                color: ["#7ed6df", "#22a6b3"], orbitColor: "#224444",
                realSpeed: "6.8 km/s", realDist: "2.9 B km", temp: "-195°C",
                gravity: "8.69 m/s²", dayLength: "17.2 Hours",
                ecc: 0.05, periapsis: 5.2,
                desc: "An ice giant that rotates on its side, likely due to a massive collision in its past."
            },
            {
                name: "Neptune", type: "gas", radius: 11, distance: 450, speed: 0.003,
                color: ["#4834d4", "#30336b"], orbitColor: "#222255",
                realSpeed: "5.4 km/s", realDist: "4.5 B km", temp: "-200°C",
                gravity: "11.15 m/s²", dayLength: "16.1 Hours",
                ecc: 0.01, periapsis: 1.5,
                desc: "Dark, cold, and whipped by supersonic winds. It was the first planet located through mathematical calculations."
            }
        ];

        // Stars
        const stars = [];
        // Generate stars across a normalized space (0 to 1)
        // Reduced number of stars from 800 to 300
        for(let i=0; i<300; i++) {
            stars.push({
                x: Math.random(), // Normalized 0-1
                y: Math.random(), // Normalized 0-1
                // Reduced star size range from 0.5-2.0 to 0.2-1.0
                size: Math.random() * 0.8 + 0.2,
                opacity: Math.random(),
                twinkleDir: Math.random() < 0.5 ? 1 : -1,
                twinkleSpeed: Math.random() * 0.01 + 0.002
            });
        }

        // Asteroids
        const asteroids = [];
        for(let i=0; i<300; i++) {
            const angle = Math.random() * Math.PI * 2;
            const dist = 190 + Math.random() * 40;
            asteroids.push({
                angle: angle,
                dist: dist,
                speed: (0.012 + Math.random() * 0.005) * (Math.random() < 0.5 ? 1 : 1),
                size: Math.random() * 2 + 0.5
            });
        }

        let sunRotation = 0;
        let selectedPlanet = null;
        let mousePos = { x: 0, y: 0 };
        planets.forEach(p => p.angle = Math.random() * Math.PI * 2);

        // --- Drawing ---

        function drawStars() {
            ctx.fillStyle = "white";
            
            // Calculate parallax offset based on drag
            // 0.2 factor makes background move slower than foreground (depth effect)
            const pX = offsetX * 0.2;
            const pY = offsetY * 0.2;

            stars.forEach(star => {
                // 1. Twinkle Animation
                star.opacity += star.twinkleDir * star.twinkleSpeed;
                if (star.opacity > 1) { star.opacity = 1; star.twinkleDir = -1; }
                else if (star.opacity < 0.2) { star.opacity = 0.2; star.twinkleDir = 1; }
                
                ctx.globalAlpha = star.opacity;
                ctx.beginPath();

                // 2. Infinite Wrapping Logic
                // We map the normalized (0-1) coordinates to current screen size
                // Then add the offset and use modulo (%) to wrap around
                let x = (star.x * width + pX) % width;
                let y = (star.y * height + pY) % height;

                // Handle negative wrapping (when dragging right/down)
                if (x < 0) x += width;
                if (y < 0) y += height;
                
                ctx.arc(x, y, star.size, 0, Math.PI*2);
                ctx.fill();
            });
            ctx.globalAlpha = 1.0;
        }

        function drawSun() {
            const zScale = baseScale * zoomLevel;
            const x = centerX + offsetX;
            const y = centerY + offsetY;
            const r = 30 * zScale;

            ctx.save();
            ctx.translate(x, y);
            ctx.rotate(sunRotation);
            
            ctx.shadowBlur = 80 * zoomLevel;
            ctx.shadowColor = "#ffaa00";
            
            const gradient = ctx.createRadialGradient(0, 0, r*0.2, 0, 0, r);
            gradient.addColorStop(0, "#fff");
            gradient.addColorStop(0.2, "#f1c40f");
            gradient.addColorStop(1, "#e67e22");
            
            ctx.fillStyle = gradient;
            ctx.beginPath();
            ctx.arc(0, 0, r, 0, Math.PI * 2);
            ctx.fill();

            // Sun texture details
            ctx.shadowBlur = 0;
            ctx.fillStyle = "rgba(160, 60, 0, 0.2)";
            for(let i=0; i<5; i++) {
                ctx.beginPath();
                ctx.arc(Math.cos(i*2)*r*0.5, Math.sin(i*3)*r*0.4, r*0.15, 0, Math.PI*2);
                ctx.fill();
            }

            ctx.restore();
        }

        function drawPlanetTexture(ctx, p, r) {
            // Base Sphere Gradient (Simulate 3D)
            const grad = ctx.createRadialGradient(-r*0.3, -r*0.3, r*0.2, 0, 0, r);
            grad.addColorStop(0, p.color[0]);
            grad.addColorStop(1, p.color[1]);
            ctx.fillStyle = grad;
            ctx.fill();

            // Texture Logic
            ctx.save();
            ctx.clip(); 

            if (p.type === 'gas' || p.type === 'ringed') {
                ctx.fillStyle = "rgba(255,255,255,0.15)";
                ctx.fillRect(-r, -r*0.6, r*2, r*0.2);
                ctx.fillRect(-r, -r*0.1, r*2, r*0.2);
                ctx.fillRect(-r, r*0.4, r*2, r*0.1);
                ctx.fillStyle = "rgba(0,0,0,0.1)";
                ctx.fillRect(-r, -r*0.4, r*2, r*0.1);
            } else if (p.type === 'earth') {
                ctx.fillStyle = "#2ecc71";
                ctx.beginPath();
                ctx.arc(-r*0.4, -r*0.4, r*0.4, 0, Math.PI*2);
                ctx.arc(r*0.5, r*0.2, r*0.5, 0, Math.PI*2);
                ctx.fill();
                ctx.shadowBlur = 10;
                ctx.shadowColor = "#4db8ff";
            } else if (p.type === 'terrestrial' && p.name === 'Mars') {
                ctx.fillStyle = "rgba(100,0,0,0.3)";
                ctx.beginPath();
                ctx.arc(r*0.3, -r*0.3, r*0.3, 0, Math.PI*2);
                ctx.arc(-r*0.2, r*0.4, r*0.25, 0, Math.PI*2);
                ctx.fill();
            } else if (p.type === 'atmosphere') {
                ctx.fillStyle = "rgba(255,255,255,0.2)";
                ctx.beginPath();
                ctx.arc(r*0.2, r*0.2, r*0.6, 0, Math.PI*2);
                ctx.fill();
                ctx.shadowBlur = 10;
                ctx.shadowColor = "#f39c12";
            }

            ctx.restore();

            // Rings for Saturn
            if (p.type === 'ringed') {
                ctx.beginPath();
                ctx.strokeStyle = "rgba(200, 180, 150, 0.6)";
                ctx.lineWidth = r * 0.4;
                ctx.ellipse(0, 0, r * 2.2, r * 0.8, Math.PI * 0.1, 0, Math.PI * 2);
                ctx.stroke();
                
                ctx.beginPath();
                ctx.strokeStyle = "rgba(0,0,0,0.8)"; 
                ctx.lineWidth = 1;
                ctx.ellipse(0, 0, r * 1.8, r * 0.65, Math.PI * 0.1, 0, Math.PI * 2);
                ctx.stroke();
            }
        }

        function drawPlanets() {
            const zScale = baseScale * zoomLevel;
            const sunX = centerX + offsetX;
            const sunY = centerY + offsetY;
            
            planets.forEach(p => {
                p.angle += p.speed * simSpeed;

                // --- Keplerian Orbit Logic ---
                // a = Semi-major axis
                // e = Eccentricity
                // b = Semi-minor axis: a * sqrt(1 - e^2)
                // c = Linear eccentricity (distance from center to focus): a * e
                
                const a = p.distance * zScale;
                const e = p.ecc;
                const b = a * Math.sqrt(1 - e * e);
                const c = a * e;

                // Center of the ellipse is offset from the Sun (focus) by 'c'
                // The offset direction depends on the orbit orientation (periapsis)
                // We rotate the ellipse by p.periapsis
                const orbitCenterX = sunX - c * Math.cos(p.periapsis);
                const orbitCenterY = sunY - c * Math.sin(p.periapsis);

                // Calculate Planet Position on Ellipse
                // Standard Parametric: x = a*cos(t), y = b*sin(t)
                // We assume p.angle approximates the Eccentric Anomaly for constant speed visualization
                const localX = a * Math.cos(p.angle);
                const localY = b * Math.sin(p.angle);

                // Rotate the point by the periapsis angle
                const rotatedX = localX * Math.cos(p.periapsis) - localY * Math.sin(p.periapsis);
                const rotatedY = localX * Math.sin(p.periapsis) + localY * Math.cos(p.periapsis);

                // Final screen position
                p.currentX = orbitCenterX + rotatedX;
                p.currentY = orbitCenterY + rotatedY;
                
                const planetR = p.radius * zScale;

                // Draw Elliptical Orbit Path
                ctx.beginPath();
                ctx.strokeStyle = p.orbitColor;
                ctx.lineWidth = 1;
                // ellipse(x, y, radiusX, radiusY, rotation, startAngle, endAngle)
                ctx.ellipse(orbitCenterX, orbitCenterY, a, b, p.periapsis, 0, Math.PI * 2);
                ctx.stroke();

                ctx.save();
                ctx.translate(p.currentX, p.currentY);

                if (p === selectedPlanet) {
                    ctx.shadowBlur = 20;
                    ctx.shadowColor = "white";
                    ctx.strokeStyle = "white";
                    ctx.lineWidth = 2;
                    ctx.beginPath();
                    ctx.arc(0, 0, planetR + 2, 0, Math.PI*2);
                    ctx.stroke();
                }

                ctx.beginPath();
                ctx.arc(0, 0, planetR, 0, Math.PI * 2);
                drawPlanetTexture(ctx, p, planetR);
                ctx.restore(); 

                if (zoomLevel > 0.6 || p === selectedPlanet) {
                    ctx.fillStyle = "rgba(255,255,255,0.8)";
                    ctx.font = `${10 * zoomLevel + 4}px Arial`;
                    ctx.textAlign = "center";
                    ctx.fillText(p.name, p.currentX, p.currentY + planetR + 15 * zoomLevel);
                }
            });
        }

        function drawAsteroids() {
            const zScale = baseScale * zoomLevel;
            ctx.fillStyle = "#888";
            asteroids.forEach(ast => {
                ast.angle += ast.speed * 0.5 * simSpeed;
                const r = ast.dist * zScale;
                const x = centerX + offsetX + Math.cos(ast.angle) * r;
                const y = centerY + offsetY + Math.sin(ast.angle) * r;
                const size = ast.size * zScale;

                ctx.beginPath();
                ctx.arc(x, y, size, 0, Math.PI*2);
                ctx.fill();
            });
        }

        function animate() {
            ctx.fillStyle = "black";
            ctx.fillRect(0,0, width, height);

            drawStars();
            
            if(simSpeed > 0) sunRotation += 0.005 * simSpeed;
            drawSun();

            drawAsteroids();
            drawPlanets();

            requestAnimationFrame(animate);
        }

        // --- Inputs ---

        canvas.addEventListener('wheel', (e) => {
            e.preventDefault();
            const delta = -Math.sign(e.deltaY) * 0.1;
            zoomLevel += delta;
            zoomLevel = Math.max(0.2, Math.min(zoomLevel, 5.0));
        }, { passive: false });

        canvas.addEventListener('mousedown', (e) => {
            if(e.target === canvas) {
                isDragging = true;
                lastMouseX = e.clientX;
                lastMouseY = e.clientY;
            }
        });
        window.addEventListener('mouseup', () => isDragging = false);
        window.addEventListener('mousemove', (e) => {
            if(isDragging) {
                offsetX += e.clientX - lastMouseX;
                offsetY += e.clientY - lastMouseY;
                lastMouseX = e.clientX;
                lastMouseY = e.clientY;
            }

            const rect = canvas.getBoundingClientRect();
            mousePos.x = e.clientX - rect.left;
            mousePos.y = e.clientY - rect.top;
            
            let hovering = false;
            const zScale = baseScale * zoomLevel;
            planets.forEach(p => {
                const dist = Math.hypot(mousePos.x - p.currentX, mousePos.y - p.currentY);
                if (dist < p.radius * zScale + 5) hovering = true;
            });
            canvas.style.cursor = isDragging ? "grabbing" : (hovering ? "pointer" : "default");
        });

        canvas.addEventListener('click', (e) => {
            if (isDragging) return;
            const rect = canvas.getBoundingClientRect();
            const clickX = e.clientX - rect.left;
            const clickY = e.clientY - rect.top;
            
            let clickedPlanet = null;
            const zScale = baseScale * zoomLevel;

            planets.forEach(p => {
                const dist = Math.hypot(clickX - p.currentX, clickY - p.currentY);
                if (dist < p.radius * zScale + 10) clickedPlanet = p;
            });

            if (clickedPlanet) {
                showInfo(clickedPlanet);
                selectedPlanet = clickedPlanet;
            } else if (e.target === canvas) {
                hideInfo();
                selectedPlanet = null;
            }
        });

        const infoPanel = document.getElementById('info-panel');
        const closeBtn = document.getElementById('close-btn');

        function showInfo(planet) {
            document.getElementById('p-name').textContent = planet.name;
            document.getElementById('p-speed').textContent = planet.realSpeed;
            document.getElementById('p-dist').textContent = planet.realDist;
            document.getElementById('p-temp').textContent = planet.temp;
            document.getElementById('p-gravity').textContent = planet.gravity;
            document.getElementById('p-day').textContent = planet.dayLength;
            document.getElementById('p-desc').textContent = planet.desc;
            infoPanel.classList.add('active');
        }

        function hideInfo() {
            infoPanel.classList.remove('active');
            selectedPlanet = null;
        }
        closeBtn.addEventListener('click', hideInfo);

        animate();

    </script>
</body>
</html>